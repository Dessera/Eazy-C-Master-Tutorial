# 函数

---

还记得我们在最开始提到的`main`函数吗？当时，我们将他描述为程序的入口，一个工作流程的开始。现在，我们将正式开始学习函数的知识。

## 一切都要从数学开始

大家都了解数学中的函数，比如说`y = f(x)`。在这个函数中，`x`是自变量，`y`是因变量，`f(x)`是函数。大体来说，一个函数就是接受一个或多个输入，然后进行一些操作，最后返回一个输出。

C 语言中的函数也是类似，它接受一些输入，进行一些操作，然后返回一个输出。

C 语言函数一般分为函数声明和函数定义两部分，函数声明表示告诉编译器这个函数的存在，函数定义表示告诉编译器这个函数的具体实现。

下面是一个简单的函数声明和定义：

```c

// 函数声明
int add(int a, int b);  // 声明一个函数，函数名为 add，接受两个 int 类型的参数，返回一个 int 类型的值

// 函数定义
int add(int a, int b) {  // 定义一个函数，函数名为 add，接受两个 int 类型的参数，返回一个 int 类型的值
    return a + b;  // 返回 a 和 b 的和
}

```

> 函数声明不是必须的，如果你的函数定义在函数调用之前，那么你可以不用声明函数。

## 此函数非彼函数

尽管 C 语言中的函数和数学中的函数有一些相似之处，但他们本质上并不相同：

- C 语言中的函数可以没有返回值，也可以没有参数（声明为`void`）

  ```c
  // 一个没有返回值，没有参数的函数，它的作用是打印Hello, world!
  void print_hello() {
      printf("Hello, world!\n");
  }
  ```

- C 语言中的函数并不保证输入和输出的严格对应，也就是说，输入相同的参数，函数的返回值不一定相同

  ```c
  int glob_val = 0;
  // 一个接受一个 int 类型的参数，返回一个 int 类型的值的函数
  // 即便输入相同的参数，返回值也不一定相同
  int plus_val(int val) {
      glob_val += val;
      return glob_val;
  }
  ```

  > 我们也可以把这种输入输出不严格对应的函数称为不纯函数，相反，输入输出严格对应的函数称为纯函数。

## 函数调用

要使用一个函数，我们需要使用函数调用运算符`()`，并且在括号中传入参数。下面是一个简单的函数调用：

```c

// add 函数的声明和定义
int add(int a, int b) {
    return a + b;
}

int main() {
    int x = 1;
    int y = 2;
    int res = add(x, y);  // 调用 add 函数，传入 x 和 y 作为参数
    printf("%d\n", res);  // 输出 res 的值（调用 printf 函数）
    return 0;
}

```

## 函数的参数传递

看向上面的`add`函数，我们声明了它有两个参数——`a`和`b`，他们的类型都是`int`。这里的`a`和`b`是函数的形式参数，也就是说，他们只在函数内部有效。

而在函数调用的时候，我们传入的参数`x`和`y`，他们是函数的实际参数，也就是说，他们是真正的数据。

在参数由实际参数传递给形式参数的过程中，`x`和`y`的值被复制到了`a`和`b`中，这种参数传递方式称为值传递。

值传递导致了我么在函数中获得的参数与函数调用时传入的参数是完全独立的，也就是说，我们在函数中修改参数的值并不会影响到函数调用时传入的参数。

```c

int add(int a, int b) {
    a = 2;  // 修改 a 的值
    return a + b;
}

int main() {
    int x = 1;
    int y = 2;
    int res = add(x, y);
    printf("%d\n", res);  // 输出 4
    printf("%d\n", x);    // 输出 1
    return 0;
}

```

如果我们想在函数中修改函数调用时传入的参数，我们需要特殊的手段，我们将在[高级数据类型](06-高级数据类型.md)与[指针](07-指针.md)中介绍。

## 主函数

在 C 语言中，`main`函数是程序的入口，也是程序的起点。在程序运行时，操作系统会首先调用`main`函数，然后执行`main`函数中的代码。

> 在某些特定的环境下，主函数不一定是`main`，这是可以更改的。

`main`函数的定义有两种形式：

```c

// 无参数的 main 函数
int main() {
    // 代码
    return 0;
}

```

```c

// 带参数的 main 函数
int main(int argc, char *argv[]) {
    // 代码
    return 0;
}

```

带参数的`main`函数是为了接受命令行参数而设计的，`argc`表示命令行参数的数量，`argv`是一个指向字符串数组的指针，每个字符串都是一个命令行参数。

> 后续课程并不会涉及命令行参数，所以我们不会深入介绍带参数的`main`函数。

现在，主函数可以不显式地返回 0，如果没有显式地返回 0，那么编译器会自动在函数的最后插入`return 0;`，例如：

```c

int main() {
    // 代码
}

```

这时编译器会自动在函数的最后插入`return 0;`，使得`main`函数返回 0。

> 请注意，这种性质只适用于`main`函数。

## 练习

> 什么？还是那个华氏度和摄氏度的转换问题？现在，要求设计一个fahr2Cels函数，它可以完成将华氏度转换成摄氏度的工作，你应该怎样设计这个函数？使用它分别计算0华氏度，50华氏度的结果并且打印出来

[参考答案请点击这里](../../code/exercise/Exercise_05.md)
